[{"D:\\WORK\\Programming\\React\\capital-react\\src\\index.js":"1","D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalFooter.js":"2","D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalModule.js":"3","D:\\WORK\\Programming\\React\\capital-react\\src\\Capital.js":"4","D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalHeader.js":"5","D:\\WORK\\Programming\\React\\capital-react\\src\\icons\\Refresh.js":"6","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\measure\\Measure.js":"7","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\measure\\MeasureForm.js":"8","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\material\\Material.js":"9","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\unitmeasure\\Unitmeasure.js":"10","D:\\WORK\\Programming\\React\\capital-react\\src\\lib\\const.js":"11","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\edizm\\Edizm.js":"12","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\unitmeasure\\UnitmeasureForm.js":"13"},{"size":317,"mtime":1613143920495,"results":"14","hashOfConfig":"15"},{"size":258,"mtime":1611901660359,"results":"16","hashOfConfig":"15"},{"size":1024,"mtime":1613374026700,"results":"17","hashOfConfig":"15"},{"size":408,"mtime":1611896091634,"results":"18","hashOfConfig":"15"},{"size":665,"mtime":1613374554384,"results":"19","hashOfConfig":"15"},{"size":430,"mtime":1612759704397,"results":"20","hashOfConfig":"15"},{"size":12903,"mtime":1613374613671,"results":"21","hashOfConfig":"15"},{"size":7277,"mtime":1613406290833,"results":"22","hashOfConfig":"15"},{"size":998,"mtime":1613373753420,"results":"23","hashOfConfig":"15"},{"size":15341,"mtime":1613474771031,"results":"24","hashOfConfig":"15"},{"size":108,"mtime":1613475328729,"results":"25","hashOfConfig":"15"},{"size":1015,"mtime":1613374439052,"results":"26","hashOfConfig":"15"},{"size":7285,"mtime":1613406290833,"results":"27","hashOfConfig":"15"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},"e7c4t8",{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"38"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"41"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"44","messages":"45","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"46"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"49","messages":"50","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"51","messages":"52","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"53"},{"filePath":"54","messages":"55","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"56","messages":"57","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"D:\\WORK\\Programming\\React\\capital-react\\src\\index.js",[],["60","61"],"D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalFooter.js",[],["62","63"],"D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalModule.js",[],"D:\\WORK\\Programming\\React\\capital-react\\src\\Capital.js",[],["64","65"],"D:\\WORK\\Programming\\React\\capital-react\\src\\CapitalHeader.js",[],["66","67"],"D:\\WORK\\Programming\\React\\capital-react\\src\\icons\\Refresh.js",[],"D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\measure\\Measure.js",["68"],"import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport '../../resources/css/index.css';\r\nimport '../../resources/css/capital.css';\r\nimport { Layout, Menu, Modal,Form } from 'antd';\r\nimport { Table } from 'antd';\r\nimport reqwest from 'reqwest';\r\nimport { PlusOutlined, EditOutlined, CloseOutlined, PrinterOutlined } from '@ant-design/icons';\r\nimport Refresh from '../../icons/Refresh';\r\nimport { notification } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport * as globalSettings from \"../../lib/const\";\r\nimport MeasureForm from \"./MeasureForm\";\r\n\r\n\r\n// URI для использования формой добавления/изменения\r\nconst URI_ROOT = globalSettings.startURL + \"measure\"\r\nconst URI_SELECT = URI_ROOT + \"/json\"\r\nconst URI_DEL = URI_ROOT + \"/del\"\r\nconst URI_ADD = URI_ROOT + \"/add\"\r\nconst URI_UPD = URI_ROOT + \"/upd\" // для выборки записи по id\r\nconst URI_POST = URI_ROOT + \"/post\"\r\n\r\n\r\nconst { Header, Content, Footer } = Layout;\r\n\r\nconst { SubMenu } = Menu;\r\n\r\n// Описание столбцов\r\n// id не надо! - Его описать в key таблицы\r\nconst columns = [\r\n  {\r\n    title: 'Наименование',\r\n    dataIndex: 'name',\r\n    sorter: true,\r\n    width1: '20%',\r\n  },\r\n];\r\n\r\n/**\r\n * Компонент для меры измерения\r\n * @param {*} props \r\n */\r\nconst Measure = ()=>{\r\n  let [currentMenu, setCurrentMenu] = React.useState(\"null\"); // Текущее выбранное меню - непонятно зачем\r\n  let [selectedRowKeys, setSelectedRowKeys] = React.useState([]); // Отмеченные записи, изначально пустой\r\n  let [data,setData] = React.useState(null); // Основной массив данных - пустой сначала\r\n  let [loading,setLoading] = React.useState(false); // Момент загрузки данных для блокировки таблицы для действий\r\n  let [pagination,setPagination] = React.useState({ // Пагинация таблицы, нумерация с 1\r\n    current: 1,\r\n    pageSize: 10,\r\n    total: null, // общее количество считанных записей\r\n  });\r\n  let [sorters, setSorters] = React.useState([{ // Массив сортировки, \r\n    fieldName: \"id\",  // Изначально по id (без сортировки с пагинацией нельзя)\r\n    sortOrder: \"ascend\"\r\n  }]);\r\n  let [totalMax, setTotalMax] = React.useState(0); // Наибольшее количесвто выбранных записей\r\n\r\n  let [formVisible,setFormVisible] = React.useState(false); // Видимость формы ввода\r\n  let [editorContext] = React.useState({ // Данные для формы добавления-изменения\r\n    uriForAdd: URI_ADD,\r\n    uriForUpd: URI_UPD,\r\n    uriForPost: URI_POST,\r\n  });\r\n  const [form] = Form.useForm(); // для эффекта\r\n\r\n  /**\r\n   * Удаление записей\r\n   */\r\n  const deleteRows = () => {\r\n    if (!(selectedRowKeys.length > 0)) {\r\n      notification.info({\r\n        message:\"Нет записей для удаления\",\r\n        description: \"Отметьте одну или несколько записей для удаления\"\r\n      });\r\n      return;\r\n    }\r\n    let ids = selectedRowKeys.join(',');\r\n    console.log('Deleting records ', ids, ' ...');\r\n    setLoading(true); // Блокируем отклики таблицы\r\n    // запрос к REST API на удаление записей\r\n    // globalSettings.startURL устанавливается в const.js\r\n    reqwest({\r\n      url: URI_DEL + '/' + ids,\r\n      contentType: \"application/json; charset=utf-8\",\r\n      method: 'post',\r\n      type: 'json',\r\n    }).then((responseJson) => {\r\n      console.log('responseJson=', responseJson);\r\n      const { errorCode } = responseJson;\r\n      if (errorCode) { // Ошибка есть\r\n        console.log('errorCode=', errorCode);\r\n        const { errorMessage, fieldErrors } = responseJson;\r\n        const description = errorMessage + fieldErrors.id;\r\n        notification.error({\r\n          message:\"Ошибка при удалении записей\",\r\n          description: (description)\r\n        });\r\n        } else { // ошибки нет\r\n          console.log('Удалили ' + ids);\r\n          refreshData();\r\n          const description = \"Удаление \" + selectedRowKeys.length + \" записей выполнено успешно\";\r\n          notification.success({\r\n            message:\"Успешно\",\r\n            description: (description)\r\n          });\r\n      }\r\n      setLoading(false);\r\n      return;\r\n    }).catch((error) => {\r\n      setLoading(false);\r\n      throw (error);\r\n    });\r\n    setLoading(false);\r\n  }\r\n\r\n  /**\r\n   * Вызов формы добавления-изменения\r\n   * @param {*} id \r\n   */\r\n  const callForm = (id) => {\r\n    console.log('calForm - id = ' + id);\r\n    editorContext.id = id;\r\n    setFormVisible(true); // Видимость формы\r\n  }\r\n\r\n  /**\r\n   * Обработчик нажатия меню\r\n   * @param {*} e \r\n   */\r\n  const handleMenuClick = e => {\r\n    console.log('click ', e);\r\n    const { key } = e;\r\n    currentMenu = key;\r\n    setCurrentMenu(setCurrentMenu);\r\n    switch(key) {\r\n      case 'add':\r\n        console.log('add');\r\n        callForm(); // Вызовем форму без установленного параметра id\r\n        break;\r\n      case 'delete':\r\n        if (!(selectedRowKeys.length > 0)) {\r\n          notification.info({\r\n            message:\"Нет записей для удаления\",\r\n            description: \"Отметьте одну или несколько записей для удаления\"\r\n          });\r\n          return;\r\n        }\r\n        const content = \"Вы действительно хотите удалить \" + selectedRowKeys.length + \" записей?\";\r\n        Modal.confirm({\r\n          title: 'Подтверждение удаления',\r\n          icon: <ExclamationCircleOutlined />,\r\n          content: (content),\r\n          okText: 'Да, конечно!',\r\n          cancelText: 'Нет, я ошибся',\r\n          onOk:()=>{\r\n            deleteRows();\r\n          }\r\n        });\r\n        break;\r\n      case 'refresh':\r\n        refreshData();\r\n        break;\r\n      case 'print':\r\n          notification.success({\r\n            message:\"Успешно\",\r\n            description:\"Удаление записей выполнено успешно\"\r\n          });\r\n            break;\r\n      default:\r\n        console.log('Не реализовано ');\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Сохранение отметки записей\r\n   * @param {*} selectedRowKeysNew \r\n   */\r\n  const onSelectChange = selectedRowKeysNew => {\r\n    setSelectedRowKeys( selectedRowKeysNew );\r\n  };\r\n\r\n  /**\r\n   * Отмеченные записи \r\n   */\r\n  const rowSelection = {\r\n    selectedRowKeys,\r\n    onChange: onSelectChange,\r\n  };\r\n\r\n  /**\r\n   * Обработчик смены параметров запроса из таблицы\r\n   * @param {*} paginationNew // При смене пагинации\r\n   * @param {*} filters // фильтра\r\n   * @param {*} sorter  // сортировки\r\n   */\r\n  const handleTableChange = (paginationNew, filters, sorter) => {\r\n    console.log('handleTableChange - start');\r\n    if (sorter.field) {\r\n      sorters = [{\r\n        fieldName: sorter.field, \r\n        sortOrder: sorter.order\r\n      }];\r\n      setSorters(sorters);\r\n    }  \r\n    pagination = paginationNew;\r\n    setPagination(pagination);\r\n    refreshData();\r\n    console.log('handleTableChange - finish');\r\n  };\r\n\r\n  /**\r\n   * Основная перевыборка данных\r\n   */\r\n  const refreshData = () => {\r\n    console.log('refreshData - start');\r\n    setLoading(true);\r\n    const gridDataOption = {\r\n      pageNumber: pagination.current - 1,\r\n      pageSize: pagination.pageSize,\r\n      sort: [{fieldName: \"id\"}] // Сортировка по умолчанию\r\n    };\r\n    if (sorters) { // Сортировка установлена - переустановим\r\n      gridDataOption.sort[0].fieldName = sorters[0].fieldName;\r\n      if (sorters[0].sortOrder === \"descend\") {\r\n        gridDataOption.sort[0].direction = 1;\r\n      }\r\n    }\r\n    console.log('gridDataOption=' + JSON.stringify(gridDataOption));\r\n    // Вычисляем total для таблицы\r\n    let total = (gridDataOption.pageNumber + 2) * gridDataOption.pageSize;\r\n    if (total < totalMax) {\r\n      total = totalMax;\r\n    } else {\r\n      setTotalMax(total);\r\n    }\r\n    // запрос к REST API на выборку\r\n    reqwest({\r\n      url: URI_SELECT,\r\n      contentType: \"application/json; charset=utf-8\",\r\n      method: 'post',\r\n      type: 'json',\r\n      data:JSON.stringify(gridDataOption)\r\n    })\r\n      .then(dataNew => {\r\n        setData(dataNew); // данные новые\r\n        setPagination({...pagination, total:  total}); // переустановим total у таблицы\r\n        setSelectedRowKeys([]); // обнулим отмеченные\r\n      },\r\n      // todo Сделать обработку ошибок\r\n      (error) => {\r\n        notification.error({\r\n          message:\"Ошибка при выборке за пределами программы\",\r\n          description: \"error\"\r\n        });\r\n        console.log('refreshData - error=' + error);\r\n      }\r\n    );\r\n    setLoading(false);\r\n    console.log('refreshData - finish');\r\n  }\r\n\r\n  /**\r\n   * Используем побочный эффект для первоначальной выборки \r\n   */\r\n  React.useEffect(() => {\r\n    if(!data) {      // Делаем только если данных нет, иначе начальный refresh выполняется бесконечно\r\n      console.log(\"useEffect - initial refresh\")\r\n      setData([]); // Непонятно зачем\r\n      refreshData();\r\n      console.log(\"useEffect - initial refreshed\")\r\n    }\r\n  }); \r\n\r\n  /**\r\n   * Возвращаем React компонент\r\n   */\r\n  return (\r\n    <div className=\"CapitalModule\">\r\n      <div className=\"Measure\">\r\n      <Layout>\r\n          <Header>\r\n            Список мер измерения\r\n          </Header>\r\n            <div>\r\n              <Menu onClick={handleMenuClick} selectedKeys={[currentMenu]} mode=\"horizontal\">\r\n                <SubMenu key=\"Command\" title=\"Команды\">\r\n                    <Menu.Item key=\"add\" icon={<PlusOutlined />}>Добавить</Menu.Item>\r\n                    <Menu.Item key=\"edit\" icon={<EditOutlined />}>Изменить</Menu.Item>\r\n                    <Menu.Item key=\"delete\" icon={<CloseOutlined />}>Удалить</Menu.Item>\r\n                    <Menu.Item key=\"refresh\" icon={<Refresh />}>Обновить</Menu.Item>\r\n                    <Menu.Item key=\"print\" icon={<PrinterOutlined />}>Печать</Menu.Item>\r\n                </SubMenu>\r\n                <SubMenu key=\"Spravka\" title=\"Справка\">\r\n                  <Menu.Item key=\"help\">Помощь</Menu.Item>\r\n                    <Menu.Item key=\"about\">\r\n                      <a href=\"http://www.gelicon.biz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        О программе\r\n                      </a>\r\n                    </Menu.Item>\r\n                </SubMenu>\r\n              </Menu>\r\n            </div>\r\n          <Content>\r\n            <div>\r\n              <Table \r\n                className=\"mod-main-table\" \r\n                rowClassName=\"table-editable-row\"  \r\n                bordered \r\n                size={\"middle\"}\r\n                loading={loading}\r\n                rowSelection={rowSelection} \r\n                columns={columns} \r\n                dataSource={data}\r\n                pagination={pagination}\r\n                onChange={handleTableChange}\r\n                rowKey=\"id\"\r\n                onRow={(record, rowIndex) => {\r\n                  return {\r\n                    onClick: event => callForm(record.id)\r\n                  };\r\n                }}\r\n              />\r\n            </div>\r\n            <MeasureForm \r\n              form={form}\r\n              visible={formVisible}\r\n              editorContext={editorContext}\r\n              afterCancel = {() => {\r\n                setFormVisible(false);\r\n              }}\r\n              afterSave={()=>{\r\n                setFormVisible(false);\r\n                refreshData();\r\n              }}\r\n            >\r\n            </MeasureForm>\r\n          </Content>\r\n          <Footer>Низ Капитал</Footer>\r\n        </Layout>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Measure;\r\n\r\n// https://medium.com/@alef.duarte/using-ant-design-form-inside-a-modal-in-react-stateless-functional-component-634f33357c80\r\n","D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\measure\\MeasureForm.js",[],"D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\material\\Material.js",["69","70","71","72","73"],"D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\unitmeasure\\Unitmeasure.js",["74","75"],"import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport '../../resources/css/index.css';\r\nimport '../../resources/css/capital.css';\r\nimport { Layout, Menu, Modal,Form } from 'antd';\r\nimport { Table } from 'antd';\r\nimport reqwest from 'reqwest';\r\nimport { PlusOutlined, EditOutlined, CloseOutlined, PrinterOutlined } from '@ant-design/icons';\r\nimport Refresh from '../../icons/Refresh';\r\nimport { notification } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport * as globalSettings from \"../../lib/const\";\r\nimport UnitmeasureForm from \"./UnitmeasureForm\";\r\n\r\n\r\n// URI для использования формой добавления/изменения\r\nconst URI_ROOT = globalSettings.startURL + \"unitmeasure\"\r\nconst URI_SELECT = URI_ROOT + \"/dto\"\r\nconst URI_DEL = URI_ROOT + \"/del\"\r\nconst URI_ADD = URI_ROOT + \"/add\"\r\nconst URI_UPD = URI_ROOT + \"/upd\" // для выборки записи по id\r\nconst URI_POST = URI_ROOT + \"/post\"\r\n\r\n\r\nconst { Header, Content, Footer } = Layout;\r\n\r\nconst { SubMenu } = Menu;\r\n\r\n// id не надо - он описан в key таблицы\r\nconst columns = [\r\n  {\r\n    title: 'Наименование',\r\n    dataIndex: 'name',\r\n    sorter: {\r\n      multiple: 1,\r\n    },\r\n  },\r\n  {\r\n    title: 'Сокращение',\r\n    dataIndex: 'shortName',\r\n    key: 'short_name', // Возможно это название поля в базе\r\n    sorter: {\r\n      multiple: 2,\r\n    },\r\n  },\r\n  {\r\n    title: 'Приоритет',\r\n    dataIndex: 'priority',\r\n    sorter: {\r\n      multiple: 3,\r\n    },\r\n  },\r\n  {\r\n    title: 'Мера измерения',\r\n    dataIndex: 'measureName',\r\n    sorter: {\r\n      multiple: 4,\r\n    },\r\n    // todo сделать динамическое формирование\r\n    filters: [ \r\n      { text: 'Без меры измерения',       value:'Без меры измерения' },\r\n      { text: 'Расстояние',               value: 'Расстояние' },\r\n      { text: 'Вес',                      value: 'Вес' },\r\n      { text: 'Время',                    value: 'Время' },\r\n      { text: 'Сила электрического тока', value: 'Сила электрического тока' },\r\n      { text: 'Температура',              value: 'Температура' },\r\n      { text: 'Количество вечества',      value: 'Количество вечества' },\r\n      { text: 'Сила света',               value: 'Сила света' },\r\n    ],\r\n    onFilter: (value, record) => record.measureName.includes(value),\r\n},\r\n];\r\n\r\n/**\r\n * Компонент для меры измерения\r\n * @param {*} props \r\n */\r\nconst Unitmeasure = ()=>{\r\n  let [currentMenu, setCurrentMenu] = React.useState(\"null\"); // Текущее выбранное меню - непонятно зачем\r\n  let [selectedRowKeys, setSelectedRowKeys] = React.useState([]); // Отмеченные записи, изначально пустой\r\n  let [data,setData] = React.useState(null); // Основной массив данных - пустой сначала\r\n  let [loading,setLoading] = React.useState(false); // Момент загрузки данных для блокировки таблицы для действий\r\n  let [pagination,setPagination] = React.useState({ // Пагинация таблицы, нумерация с 1\r\n    current: 1,\r\n    pageSize: 10,\r\n    total: null, // общее количество считанных записей\r\n  });\r\n  let [sorters, setSorters] = React.useState([{ // Массив сортировки, \r\n    fieldName: \"id\",  // Изначально по id (без сортировки с пагинацией нельзя)\r\n    sortOrder: \"ascend\"\r\n  }]);\r\n  let [totalMax, setTotalMax] = React.useState(0); // Наибольшее количесвто выбранных записей\r\n\r\n  let [formVisible,setFormVisible] = React.useState(false); // Видимость формы ввода\r\n  let [editorContext] = React.useState({ // Данные для формы добавления-изменения\r\n    uriForAdd: URI_ADD,\r\n    uriForUpd: URI_UPD,\r\n    uriForPost: URI_POST,\r\n  });\r\n  const [form] = Form.useForm(); // для эффекта\r\n  let [filteredInfo, setFilteredInfo] = React.useState(0); // Фильтр\r\n\r\n\r\n  /**\r\n   * Удаление записей\r\n   */\r\n  const deleteRows = () => {\r\n    if (!(selectedRowKeys.length > 0)) {\r\n      notification.info({\r\n        message:\"Нет записей для удаления\",\r\n        description: \"Отметьте одну или несколько записей для удаления\"\r\n      });\r\n      return;\r\n    }\r\n    let ids = selectedRowKeys.join(',');\r\n    console.log('Deleting records ', ids, ' ...');\r\n    setLoading(true); // Блокируем отклики таблицы\r\n    // запрос к REST API на удаление записей\r\n    // globalSettings.startURL устанавливается в const.js\r\n    reqwest({\r\n      url: URI_DEL + '/' + ids,\r\n      contentType: \"application/json; charset=utf-8\",\r\n      method: 'post',\r\n      type: 'json',\r\n    }).then((responseJson) => {\r\n      console.log('responseJson=', responseJson);\r\n      const { errorCode } = responseJson;\r\n      if (errorCode) { // Ошибка есть\r\n        console.log('errorCode=', errorCode);\r\n        const { errorMessage, fieldErrors } = responseJson;\r\n        const description = errorMessage + fieldErrors.id;\r\n        notification.error({\r\n          message:\"Ошибка при удалении записей\",\r\n          description: (description)\r\n        });\r\n        } else { // ошибки нет\r\n          console.log('Удалили ' + ids);\r\n          refreshData();\r\n          const description = \"Удаление \" + selectedRowKeys.length + \" записей выполнено успешно\";\r\n          notification.success({\r\n            message:\"Успешно\",\r\n            description: (description)\r\n          });\r\n      }\r\n      setLoading(false);\r\n      return;\r\n    }).catch((error) => {\r\n      setLoading(false);\r\n      throw (error);\r\n    });\r\n    setLoading(false);\r\n  }\r\n\r\n  /**\r\n   * Вызов формы добавления-изменения\r\n   * @param {*} id \r\n   */\r\n  const callForm = (id) => {\r\n    console.log('calForm - id = ' + id);\r\n    editorContext.id = id;\r\n    setFormVisible(true); // Видимость формы\r\n  }\r\n\r\n  /**\r\n   * Обработчик нажатия меню\r\n   * @param {*} e \r\n   */\r\n  const handleMenuClick = e => {\r\n    console.log('click ', e);\r\n    const { key } = e;\r\n    currentMenu = key;\r\n    setCurrentMenu(setCurrentMenu);\r\n    switch(key) {\r\n      case 'add':\r\n        console.log('add');\r\n        callForm(); // Вызовем форму без установленного параметра id\r\n        break;\r\n      case 'delete':\r\n        if (!(selectedRowKeys.length > 0)) {\r\n          notification.info({\r\n            message:\"Нет записей для удаления\",\r\n            description: \"Отметьте одну или несколько записей для удаления\"\r\n          });\r\n          return;\r\n        }\r\n        const content = \"Вы действительно хотите удалить \" + selectedRowKeys.length + \" записей?\";\r\n        Modal.confirm({\r\n          title: 'Подтверждение удаления',\r\n          icon: <ExclamationCircleOutlined />,\r\n          content: (content),\r\n          okText: 'Да, конечно!',\r\n          cancelText: 'Нет, я ошибся',\r\n          onOk:()=>{\r\n            deleteRows();\r\n          }\r\n        });\r\n        break;\r\n      case 'refresh':\r\n        refreshData();\r\n        break;\r\n      case 'print':\r\n          notification.success({\r\n            message:\"Успешно\",\r\n            description:\"Удаление записей выполнено успешно\"\r\n          });\r\n            break;\r\n      default:\r\n        console.log('Не реализовано ');\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Сохранение отметки записей\r\n   * @param {*} selectedRowKeysNew \r\n   */\r\n  const onSelectChange = selectedRowKeysNew => {\r\n    setSelectedRowKeys( selectedRowKeysNew );\r\n  };\r\n\r\n  /**\r\n   * Отмеченные записи \r\n   */\r\n  const rowSelection = {\r\n    selectedRowKeys,\r\n    onChange: onSelectChange,\r\n  };\r\n\r\n  /**\r\n   * Обработчик смены параметров запроса из таблицы\r\n   * @param {*} paginationNew // При смене пагинации\r\n   * @param {*} filters // фильтра\r\n   * @param {*} sorter  // сортировки\r\n   */\r\n  const handleTableChange = (paginationNew, filters, sorter, extra) => {\r\n    if (sorter.field) { // Установлена единичкая сортировка\r\n      sorters = [{\r\n        fieldName: sorter.field, \r\n        sortOrder: sorter.order\r\n      }];\r\n      setSorters(sorters);\r\n    } else { // Возможно, установлена множественная сортировка\r\n      sorters = [];\r\n      Object.keys(sorter).forEach(element => {\r\n        if (sorter[element].field)\r\n          sorters.push({\r\n            fieldName: sorter[element].field,\r\n            sortOrder: sorter[element].order,\r\n          });\r\n      });\r\n    }\r\n    pagination = paginationNew;\r\n    setPagination(pagination);\r\n    console.log('filters = ' + JSON.stringify(filters));\r\n    setFilteredInfo(filters); // Установим переданный в параметрах фильтр\r\n    refreshData();\r\n  };\r\n\r\n  const clearFilters = () => { // Обнуление фильтра\r\n    setFilteredInfo(null); \r\n  };\r\n\r\n\r\n  /**\r\n   * Основная перевыборка данных\r\n   */\r\n  const refreshData = () => {\r\n    setLoading(true);\r\n    let gridDataOption = {\r\n      pageNumber: pagination.current - 1,\r\n      pageSize: pagination.pageSize,\r\n      sort: [{fieldName: \"id\", direction: 0}] // Сортировка по умолчанию\r\n    };\r\n    if (sorters) { // Сортировка установлена - переустановим\r\n      console.log('sorters = ' + JSON.stringify(sorters));\r\n      let sort = []; \r\n      sorters.forEach(element => {\r\n        let direction = 0;\r\n        if (element.sortOrder === \"descend\") {\r\n          direction = 1;\r\n        }\r\n        sort.push({\r\n          fieldName: element.fieldName,\r\n          direction: direction,\r\n        });      \r\n      });\r\n      gridDataOption.sort = sort;\r\n    }\r\n    console.log('gridDataOption=' + JSON.stringify(gridDataOption));\r\n    // Вычисляем total для таблицы\r\n    let total = (gridDataOption.pageNumber + 2) * gridDataOption.pageSize;\r\n    if (total < totalMax) {\r\n      total = totalMax;\r\n    } else {\r\n      totalMax = total;\r\n      setTotalMax(total);\r\n    }\r\n    console.log('total = ' + total);\r\n    // Фильтрация\r\n    filteredInfo = filteredInfo || {};\r\n    console.log('filteredInfo = ' + JSON.stringify(filteredInfo));\r\n    // запрос к REST API на выборку\r\n    reqwest({\r\n      url: URI_SELECT,\r\n      contentType: \"application/json; charset=utf-8\",\r\n      method: 'post',\r\n      type: 'json',\r\n      data:JSON.stringify(gridDataOption)\r\n    })\r\n      .then(dataNew => {\r\n        setData(dataNew); // данные новые\r\n        setPagination({...pagination, total:  total}); // переустановим total у таблицы\r\n        setSelectedRowKeys([]); // обнулим отмеченные\r\n      },\r\n      // todo Сделать обработку ошибок\r\n      (error) => {\r\n        notification.error({\r\n          message:\"Ошибка при выборке за пределами программы\",\r\n          description: \"error\"\r\n        });\r\n        console.log('refreshData - error=' + error);\r\n      }\r\n    );\r\n    setLoading(false);\r\n    console.log('refreshData - finish');\r\n  }\r\n\r\n  /**\r\n   * Используем побочный эффект для первоначальной выборки \r\n   */\r\n  React.useEffect(() => {\r\n    if(!data) {      // Делаем только если данных нет, иначе начальный refresh выполняется бесконечно\r\n      console.log(\"useEffect - initial refresh\")\r\n      setData([]); // Непонятно зачем\r\n      refreshData();\r\n      console.log(\"useEffect - initial refreshed\")\r\n    }\r\n  }); \r\n\r\n  /**\r\n   * Возвращаем React компонент\r\n   */\r\n  return (\r\n    <div className=\"CapitalModule\">\r\n      <div className=\"Unitmeasure\">\r\n      <Layout>\r\n          <Header>\r\n            Список единиц измерения\r\n          </Header>\r\n            <div>\r\n              <Menu onClick={handleMenuClick} selectedKeys={[currentMenu]} mode=\"horizontal\">\r\n                <SubMenu key=\"Command\" title=\"Команды\">\r\n                    <Menu.Item key=\"add\" icon={<PlusOutlined />}>Добавить</Menu.Item>\r\n                    <Menu.Item key=\"edit\" icon={<EditOutlined />}>Изменить</Menu.Item>\r\n                    <Menu.Item key=\"delete\" icon={<CloseOutlined />}>Удалить</Menu.Item>\r\n                    <Menu.Item key=\"refresh\" icon={<Refresh />}>Обновить</Menu.Item>\r\n                    <Menu.Item key=\"print\" icon={<PrinterOutlined />}>Печать</Menu.Item>\r\n                </SubMenu>\r\n                <SubMenu key=\"Spravka\" title=\"Справка\">\r\n                  <Menu.Item key=\"help\">Помощь</Menu.Item>\r\n                    <Menu.Item key=\"about\">\r\n                      <a href=\"http://www.gelicon.biz/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        О программе\r\n                      </a>\r\n                    </Menu.Item>\r\n                </SubMenu>\r\n              </Menu>\r\n            </div>\r\n          <Content>\r\n            <div>\r\n              <Table \r\n                className=\"mod-main-table\" \r\n                rowClassName=\"table-editable-row\"  \r\n                bordered \r\n                size={\"middle\"}\r\n                loading={loading}\r\n                rowSelection={rowSelection} \r\n                columns={columns} \r\n                dataSource={data}\r\n                pagination={pagination}\r\n                onChange={handleTableChange}\r\n                rowKey=\"id\"\r\n                onRow={(record, rowIndex) => {\r\n                  return {\r\n                    onClick: event => callForm(record.id)\r\n                  };\r\n                }}\r\n              />\r\n            </div>\r\n            <UnitmeasureForm \r\n              form={form}\r\n              visible={formVisible}\r\n              editorContext={editorContext}\r\n              afterCancel = {() => {\r\n                setFormVisible(false);\r\n              }}\r\n              afterSave={()=>{\r\n                setFormVisible(false);\r\n                refreshData();\r\n              }}\r\n            >\r\n            </UnitmeasureForm>\r\n          </Content>\r\n          <Footer>Низ Капитал</Footer>\r\n        </Layout>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Unitmeasure;\r\n\r\n// https://medium.com/@alef.duarte/using-ant-design-form-inside-a-modal-in-react-stateless-functional-component-634f33357c80\r\n","D:\\WORK\\Programming\\React\\capital-react\\src\\lib\\const.js",[],"D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\edizm\\Edizm.js",[],"D:\\WORK\\Programming\\React\\capital-react\\src\\modules\\unitmeasure\\UnitmeasureForm.js",[],{"ruleId":"76","replacedBy":"77"},{"ruleId":"78","replacedBy":"79"},{"ruleId":"76","replacedBy":"80"},{"ruleId":"78","replacedBy":"81"},{"ruleId":"76","replacedBy":"82"},{"ruleId":"78","replacedBy":"83"},{"ruleId":"76","replacedBy":"84"},{"ruleId":"78","replacedBy":"85"},{"ruleId":"86","severity":1,"message":"87","line":267,"column":3,"nodeType":"88","endLine":267,"endColumn":18,"suggestions":"89"},{"ruleId":"90","severity":1,"message":"91","line":6,"column":18,"nodeType":"92","messageId":"93","endLine":6,"endColumn":22},{"ruleId":"90","severity":1,"message":"94","line":6,"column":24,"nodeType":"92","messageId":"93","endLine":6,"endColumn":34},{"ruleId":"90","severity":1,"message":"95","line":9,"column":9,"nodeType":"92","messageId":"93","endLine":9,"endColumn":15},{"ruleId":"90","severity":1,"message":"96","line":9,"column":17,"nodeType":"92","messageId":"93","endLine":9,"endColumn":24},{"ruleId":"90","severity":1,"message":"97","line":9,"column":26,"nodeType":"92","messageId":"93","endLine":9,"endColumn":32},{"ruleId":"90","severity":1,"message":"98","line":258,"column":9,"nodeType":"92","messageId":"93","endLine":258,"endColumn":21},{"ruleId":"86","severity":1,"message":"87","line":330,"column":3,"nodeType":"88","endLine":330,"endColumn":18,"suggestions":"99"},"no-native-reassign",["100"],"no-negated-in-lhs",["101"],["100"],["101"],["100"],["101"],["100"],["101"],"react-hooks/exhaustive-deps","React Hook useEffect contains a call to 'setData'. Without a list of dependencies, this can lead to an infinite chain of updates. To fix this, pass [data, refreshData] as a second argument to the useEffect Hook.","MemberExpression",["102"],"no-unused-vars","'Menu' is defined but never used.","Identifier","unusedVar","'Breadcrumb' is defined but never used.","'Header' is assigned a value but never used.","'Content' is assigned a value but never used.","'Footer' is assigned a value but never used.","'clearFilters' is assigned a value but never used.",["103"],"no-global-assign","no-unsafe-negation",{"desc":"104","fix":"105"},{"desc":"104","fix":"106"},"Add dependencies array: [data, refreshData]",{"range":"107","text":"108"},{"range":"109","text":"108"},[8640,8640],", [data, refreshData]",[10655,10655]]